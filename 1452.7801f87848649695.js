"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1452],{1452:(U,m,r)=>{r.r(m),r.d(m,{BuzonPageModule:()=>C});var h=r(9808),n=r(4182),i=r(5649),c=r(3515),l=r(655),g=r(7905);class f{constructor(){this.toString=()=>`**Tipo: ** ${this.tipo}\n**Sede: ** ${this.sede}\n\n\n---\n\n>${this.multilineFormated(this.mensaje)}`,this.multilineFormated=s=>s.replaceAll(/\n\n/gi,"\n\n>")}deserialize(s){return Object.assign(this,s),this}}var v=r(9456),e=r(2096),Z=r(7852),z=r(3646),A=r(4662);const T=[{path:"",component:(()=>{class t{constructor(o,a,p,y,B){this.alertController=o,this.formBuilder=a,this.loadingController=p,this.router=y,this.trello=B,this.prepareTicket=()=>(new f).deserialize(this.ticketForm.value),this.prepareCard=u=>(new g.Z).deserialize({name:`${this.folio}`,desc:u.toString(),idList:this.getList()}),this.getList=()=>"Queja"===this.ticket.tipo?"627810fb53620f70c97c80d3":"627810ffc9929a564f74e8c9",this.setFolio=(u,d)=>this.folio=`${d.substring(0,3).toUpperCase()}-${this.getAcronym(u)}-${(0,v.N)()}`,this.getAcronym=u=>u.split(/\s/).reduce((d,S)=>d+S.slice(0,1),"")}ngOnInit(){return(0,l.mG)(this,void 0,void 0,function*(){this.ticketForm=this.formBuilder.group({sede:["",n.kI.required],tipo:["",n.kI.required],mensaje:["",n.kI.required]})})}ionViewWillEnter(){this.ticketForm.reset()}onClickSubmit(){return(0,l.mG)(this,void 0,void 0,function*(){const o=localStorage.getItem("rol");this.ticket=this.prepareTicket(),this.setFolio(this.ticket.sede,o),this.card=this.prepareCard(this.ticket);const a=yield this.loadingController.create({message:"Generando ticket..."});yield a.present(),setTimeout(()=>(0,l.mG)(this,void 0,void 0,function*(){return yield this.trello.post(this.card).then(()=>this.showAlertSuccess()).catch(()=>this.showAlertDimiss()).finally(()=>a.dismiss())}),1e3)})}showAlertSuccess(){return(0,l.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"Registro exitoso",message:`Su ticket ha sido registrado correctamente con el folio<br><br><center><strong>${this.folio}</strong></center>`,mode:"ios",buttons:[{text:"Nuevo reporte",id:"cancel-button",handler:()=>this.resetForm(!1)},{text:"Finalizar",id:"confirm-button",handler:()=>{this.resetForm(),this.router.navigate(["/"])}}]})).present()})}showAlertDimiss(){return(0,l.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"Ha ocurrido un error",message:"Su ticket no ha sido registrado, por favor vuelva a intentarlo<br><br>Si el problema persiste contacte al administrador del portal",mode:"ios",buttons:["Aceptar"]})).present()})}resetForm(o=!0){this.ticketForm.reset(),o||this.ticketForm.patchValue({sede:this.ticket.sede})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(i.Br),e.Y36(n.qu),e.Y36(i.HT),e.Y36(c.F0),e.Y36(Z.M))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-buzon"]],decls:41,vars:2,consts:[["no-border",""],[1,"cs-container-footer"],["fixed","",1,"ion-padding"],["novalidate","",1,"dataForm",3,"formGroup","ngSubmit"],["color","primary",1,"ion-text-left","ion-no-padding"],["position","floating"],["okText","Aceptar","cancelText","Cancelar","formControlName","sede","mode","ios"],["value","Hospital Covadonga C\xf3rdoba"],["value","Hospital Covadonga Orizaba"],["value","Hospital Covadonga Veracruz"],["value","Gabinete Veracruz"],["okText","Aceptar","cancelText","Cancelar","formControlName","tipo","mode","ios"],["value","Queja"],["value","Sugerencia"],["rows","7","formControlName","mensaje"],["expand","block","color","primary","type","submit","mode","ios",1,"ion-margin",3,"disabled"]],template:function(o,a){1&o&&(e.TgZ(0,"ion-header",0),e._UZ(1,"app-header"),e.qZA(),e.TgZ(2,"ion-content")(3,"div",1)(4,"ion-grid",2)(5,"ion-list")(6,"form",3),e.NdJ("ngSubmit",function(){return a.onClickSubmit()}),e.TgZ(7,"ion-label",4)(8,"h1")(9,"strong"),e._uU(10,"Buz\xf3n de quejas y sugerencias"),e.qZA()(),e.TgZ(11,"p"),e._uU(12,"Todos somos COVADONGA y por ello la opini\xf3n de todos es importante, utiliza este espacio siempre que lo necesites para expresarte libremente y de manera an\xf3nima, com\xe9ntanos como podemos mejorar como equipo. "),e.qZA()(),e._UZ(13,"br"),e.TgZ(14,"ion-item")(15,"ion-label",5),e._uU(16,"Sede"),e.qZA(),e.TgZ(17,"ion-select",6)(18,"ion-select-option",7),e._uU(19,"Hospital C\xf3rdoba"),e.qZA(),e.TgZ(20,"ion-select-option",8),e._uU(21,"Hospital Orizaba"),e.qZA(),e.TgZ(22,"ion-select-option",9),e._uU(23,"Hospital Veracruz"),e.qZA(),e.TgZ(24,"ion-select-option",10),e._uU(25,"Gabinete Veracruz"),e.qZA()()(),e.TgZ(26,"ion-item")(27,"ion-label",5),e._uU(28,"Tipo de reporte"),e.qZA(),e.TgZ(29,"ion-select",11)(30,"ion-select-option",12),e._uU(31,"Queja"),e.qZA(),e.TgZ(32,"ion-select-option",13),e._uU(33,"Sugerencia"),e.qZA()()(),e.TgZ(34,"ion-item")(35,"ion-label",5),e._uU(36,"Mensaje"),e.qZA(),e._UZ(37,"ion-textarea",14),e.qZA(),e.TgZ(38,"ion-button",15),e._uU(39," Enviar "),e.qZA()()()(),e._UZ(40,"app-footer"),e.qZA()()),2&o&&(e.xp6(6),e.Q6J("formGroup",a.ticketForm),e.xp6(32),e.Q6J("disabled",a.ticketForm.invalid))},directives:[i.Gu,z.G,i.W2,i.jY,i.q_,n._Y,n.JL,n.sg,i.Q$,i.Ie,i.t9,i.QI,n.JJ,n.u,i.n0,i.g2,i.j9,i.YG,A.c],styles:[".dataForm[_ngcontent-%COMP%]{max-width:768px;margin:24px auto auto}"]}),t})()}];let b=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.Bz.forChild(T)],c.Bz]}),t})();var F=r(5642);let C=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[h.ez,n.u5,i.Pc,b,n.UX,F.K]]}),t})()}}]);